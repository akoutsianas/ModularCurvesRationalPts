
// Modular curves downloaded from the LMFDB on 08 October 2025.
// Magma code for modular curve with label 21.96.3.a.1

// Other names and/or labels
// Cummins-Pauli label: 21D3
// Rouse-Sutherland-Zureick-Brown label: 21.96.3.1

// Group data
level := 21;
// Elements that, together with Gamma(level), generate the group
gens := [[1, 4, 0, 10], [1, 15, 0, 8], [13, 4, 0, 5], [20, 5, 0, 13]];
// Group contains -1?
ContainsMinus1 := true;
// Index in Gamma(1)
index := 96;

// Curve data
conductor := [[3, 3], [7, 3]];
bad_primes := [3, 7];
// Genus
g := 3;
// Rank
r := 0
;// Exact gonality known
gamma := 2;

// Modular data
// Number of cusps
Ncusps := 12
;// Number of rational cusps
Nrat_cusps := 6
;// CM discriminants
CM_discs := [];
// Modular curve is a fiber product of the following curvesfactors := ['3.4.0.a.1', '7.24.0.a.1']
// Groups containing given group, corresponding to curves covered by given curve
covers := ["7.24.0.a.1", "21.32.1.a.1"];

// Models for this modular curve, if computed
Pol<x,y,z,w,t> := PolynomialRing(Rationals(), 5);
// Isomorphic to P^1?
is_P1 := false;

// Embedded model
model_0 := [x*z^2-z^2*w+z*w*t+y*t^2-z*t^2+w*t^2,x*z^2-z^2*w+x*z*t+x*t^2+w*t^2+t^3,x^2*z-x*z*w+x^2*t-x*y*t+x*z*t+x*t^2,y*z*t-z^2*t+x*t^2-z*t^2+w*t^2+t^3,x*z*w-y*z*w-y*z*t+x*w*t,y*z*w-z*w^2+y*z*t-y*w*t+z*w*t+w*t^2,x*y*z-x*z^2+x^2*t-x*z*t+x*w*t+x*t^2,x*y*z-y*z*w+x*y*t-y^2*t+y*z*t+y*t^2,y^2*z-y*z^2+x*y*t-y*z*t+y*w*t+y*t^2,y*z*w-z^2*w+x*w*t-z*w*t+w^2*t+w*t^2,x^2*w-y^2*w-y*w^2+z*w^2-y^2*t+x*w*t-z*w*t-w*t^2,y*z^2-z^3+x*z*t-z^2*t+z*w*t+z*t^2,x^2*w-x*y*w+y^2*w-x*z*w+z*w^2-w^3+y*z*t+x*w*t-y*w*t+w*t^2,x*y*z-x^2*w-x*y*w+x*z*w-y*z*w+x*w^2-z*w^2+w^3-x*w*t-w*t^2,x^2*y-x*y^2+y^3-y^2*z+y*z*w-y*w^2+2*x*y*t-y^2*t+y*t^2,x^3-x^2*y+x*y^2-x^2*z-x*y*z+2*x*z*w-x*w^2+x^2*t-x*z*t];

// Singular plane model
model_1 := [x^4*y-x^3*y^2+x^4*z+2*x^3*y*z-3*x^2*y^2*z+2*x^3*z^2-x^2*y*z^2+x^2*z^3+y^2*z^3+y*z^4];

// Weierstrass model
model_2 := [2*x^7*z-5*x^6*z^2+6*x^5*z^3+x^4*y-2*x^4*z^4-x^3*z^5+x^2*y*z^2+2*x^2*z^6+y^2+y*z^4];

// Maps from this modular curve, if computed

// j-invariant map from the embedded model
//   Coordinate number 0:
map_0_coord_0 := -7*(174680064*x*y^11*t^3-21153083904*x*y^10*t^4-434460672*x*y^9*t^5+151812449856*x*y^8*t^6-169107922368*x*y^7*t^7-482007640896*x*y^6*t^8-128093852952*x*y^5*t^9-208633162536*x*y^4*t^10+67253696568*x*y^3*t^11-125020701204*x*y^2*t^12-621056323786*x*y*t^13-4206147750*x*w^14-34474736835*x*w^13*t-103878858888*x*w^12*t^2-6045203421*x*w^11*t^3+494022359070*x*w^10*t^4-266252150493*x*w^9*t^5-2038158409770*x*w^8*t^6+2821393586061*x*w^7*t^7+103391110413*x*w^6*t^8+1445808811026*x*w^5*t^9-5213344136031*x*w^4*t^10+28330626379*x*w^3*t^11+7882360367879*x*w^2*t^12-6313380172464*x*w*t^13-3445572993794*x*t^14-2616841728*y^12*t^3+8112545280*y^11*t^4+28955460096*y^10*t^5-97058399040*y^9*t^6+37809851328*y^8*t^7+55043494272*y^7*t^8-83605838688*y^6*t^9+192570370704*y^5*t^10-300212278488*y^4*t^11+668721254355*y^3*t^12-196564710362*y^2*t^13+4554427500*y*w^14+23359986090*y*w^13*t+29659523922*y*w^12*t^2+7260660342*y*w^11*t^3+150124561650*y*w^10*t^4-100055364075*y*w^9*t^5-29158589682*y*w^8*t^6+2080167830838*y*w^7*t^7-3980530135062*y*w^6*t^8+4189219596975*y*w^5*t^9-1025131841133*y*w^4*t^10+1142200537471*y*w^3*t^11-2851365225123*y*w^2*t^12+2290716543158*y*w*t^13+3066674375732*y*t^14-309318345*z^15-994227696*z^14*t+2922886134*z^13*t^2+10279118700*z^12*t^3+10090247193*z^11*t^4+38548116675*z^10*t^5-16648172757*z^9*t^6-925611960960*z^8*t^7-3179830812039*z^7*t^8-4765949813304*z^6*t^9-3900090037968*z^5*t^10-1889769738375*z^4*t^11-4095616048344*z^3*t^12-3895845876325*z^2*t^13+294553665*z*w^14+14996146977*z*w^13*t+57614555691*z*w^12*t^2-173633457087*z*w^11*t^3-922275907839*z*w^10*t^4+1092990986712*z*w^9*t^5+3628663127982*z*w^8*t^6-8104612958613*z*w^7*t^7+10115833223439*z*w^6*t^8-7394787644889*z*w^5*t^9+1317464227197*z*w^4*t^10-3780709127893*z*w^3*t^11+1157910419712*z*w^2*t^12+6984763775096*z*w*t^13-250444543969*z*t^14-327229875*w^15-2504059110*w^14*t-1414437633*w^13*t^2+84165586029*w^12*t^3+264256615836*w^11*t^4-304958732922*w^10*t^5-1192831494399*w^9*t^6+1348398346581*w^8*t^7-465419756961*w^7*t^8+6286703186796*w^6*t^9-6657990053388*w^5*t^10-5561238627529*w^4*t^11+3966800542050*w^3*t^12+4542154207101*w^2*t^13-6923401588059*w*t^14-3446151949556*t^15);
//   Coordinate number 1:
map_0_coord_1 := 1*(347733*x*y^14-7000587*x*y^13*t-18670419*x*y^12*t^2+101621628*x*y^11*t^3+83064933*x*y^10*t^4-515892078*x*y^9*t^5-413351748*x*y^8*t^6+756697005*x*y^7*t^7+1207580085*x*y^6*t^8+979352472*x*y^5*t^9-194483986*x*y^4*t^10+39522714*x*y^3*t^11-523492376*x*y^2*t^12-4129080718*x*y*t^13+16897923*x*w^14+151221654*x*w^13*t+540936756*x*w^12*t^2+1431583023*x*w^11*t^3+3223967934*x*w^10*t^4-917661833*x*w^9*t^5+9995988622*x*w^8*t^6-11788856493*x*w^7*t^7+17070865216*x*w^6*t^8-50058797455*x*w^5*t^9+129153796497*x*w^4*t^10-259461697191*x*w^3*t^11+476241219510*x*w^2*t^12-565078706900*x*w*t^13-882143388641*x*t^14-813564*y^15+321489*y^14*t+25839405*y^13*t^2-27904176*y^12*t^3-96043077*y^11*t^4+157409892*y^10*t^5+167284440*y^9*t^6+107389935*y^8*t^7+230033961*y^7*t^8+361532031*y^6*t^9+1366423743*y^5*t^10-466327085*y^4*t^11+2112504693*y^3*t^12-200698778*y^2*t^13-15907968*y*w^14-131218380*y*w^13*t-157147164*y*w^12*t^2-520640664*y*w^11*t^3-2016455547*y*w^10*t^4-682451117*y*w^9*t^5+7086875474*y*w^8*t^6-2616007070*y*w^7*t^7+159242258*y*w^6*t^8-11213550774*y*w^5*t^9+70526889425*y*w^4*t^10-144200762826*y*w^3*t^11+345040154836*y*w^2*t^12-514217051662*y*w*t^13+262780917649*y*t^14+813564*z^15+12229704*z^14*t+64459638*z^13*t^2+95134743*z^12*t^3-652736394*z^11*t^4-4326044517*z^10*t^5-13307646492*z^9*t^6-25089959439*z^8*t^7-36206984727*z^7*t^8-42880311582*z^6*t^9-80589675042*z^5*t^10-55033128665*z^4*t^11-211435041516*z^3*t^12+400328659061*z^2*t^13-1108350*z*w^14-49061484*z*w^13*t-429345495*z*w^12*t^2-101992665*z*w^11*t^3-2118085194*z*w^10*t^4+5826934958*z*w^9*t^5-4407676092*z*w^8*t^6+9823046225*z*w^7*t^7-39404685447*z*w^6*t^8+111072514510*z*w^5*t^9-251767114421*z*w^4*t^10+569345150814*z*w^3*t^11-1074541152002*z*w^2*t^12+1295736175553*z*w*t^13+615233390274*z*t^14-229338*w^15+17510094*w^14*t-45566964*w^13*t^2+42557064*w^12*t^3+2312678493*w^11*t^4-661269964*w^10*t^5+5062608824*w^9*t^6-490548542*w^8*t^7+6223753061*w^7*t^8-40536649716*w^6*t^9+84154809361*w^5*t^10-155249910648*w^4*t^11+301871747495*w^3*t^12-399001429946*w^2*t^13-516879726866*w*t^14-882143388641*t^15);

// Map from the embedded model to the plane model of modular curve with label 21.96.3.a.1
//   Coordinate number 0:
map_1_coord_0 := 1*(z);
//   Coordinate number 1:
map_1_coord_1 := 1*(w);
//   Coordinate number 2:
map_1_coord_2 := 1*(t);
// Codomain equation:
map_1_codomain := [x^4*y-x^3*y^2+x^4*z+2*x^3*y*z-3*x^2*y^2*z+2*x^3*z^2-x^2*y*z^2+x^2*z^3+y^2*z^3+y*z^4];

// Map from the embedded model to the Weierstrass model of modular curve with label 21.96.3.a.1
//   Coordinate number 0:
map_2_coord_0 := 1*(-t);
//   Coordinate number 1:
map_2_coord_1 := 1*(-z^3*w-z^3*t-3*z^2*w*t-4*z^2*t^2-3*z*t^3+w*t^3-t^4);
//   Coordinate number 2:
map_2_coord_2 := 1*(-z-t);
// Codomain equation:
map_2_codomain := [2*x^7*z-5*x^6*z^2+6*x^5*z^3+x^4*y-2*x^4*z^4-x^3*z^5+x^2*y*z^2+2*x^2*z^6+y^2+y*z^4];
