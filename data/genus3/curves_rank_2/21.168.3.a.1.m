
// Modular curves downloaded from the LMFDB on 09 October 2025.
// Magma code for modular curve with label 21.168.3.a.1

// Other names and/or labels
// Cummins-Pauli label: 7A3
// Rouse-Sutherland-Zureick-Brown label: 21.168.3.1

// Group data
level := 21;
// Elements that, together with Gamma(level), generate the group
gens := [[7, 13, 11, 7], [8, 7, 7, 6]];
// Group contains -1?
ContainsMinus1 := true;
// Index in Gamma(1)
index := 168;

// Curve data
conductor := [[3, 4], [7, 6]];
bad_primes := [3, 7];
// Genus
g := 3;
// Rank
r := 2
;// Exact gonality known
gamma := 3;

// Modular data
// Number of cusps
Ncusps := 24
;// Number of rational cusps
Nrat_cusps := 0
;// CM discriminants
CM_discs := [-3];
// Groups containing given group, corresponding to curves covered by given curve
covers := ["7.84.1.a.1", "21.56.1.a.1", "21.56.1.b.1"];

// Models for this modular curve, if computed
Pol<x,y,z> := PolynomialRing(Rationals(), 3);
// Isomorphic to P^1?
is_P1 := false;

// Canonical model
model_0 := [9*x^2*y^2-7*x^3*z-6*x^2*y*z+6*x*y^2*z+7*y^3*z-6*x^2*z^2+3*x*y*z^2-6*y^2*z^2-4*x*z^3+4*y*z^3-3*z^4];

// Maps from this modular curve, if computed

// j-invariant map from the canonical model
//   Coordinate number 0:
map_0_coord_0 := 3^2*7^3*(z*(34603621701026571896586467135650776576*x^40*y-11534540567008857298862155711883592192*x^40*z+461381622680354291954486228475343687680*x^39*y*z-1411646203189255290256579102979827590720*x^39*z^2+2998980547422302897704160485089733969920*x^38*y*z^2-17351740458986217807434141510374514022720*x^38*z^3+35904358460938439229563304218118814011576*x^37*y*z^3-115531294571556219739561881058777643989032*x^37*z^4+325693569638358587326501595300238540539784*x^36*y*z^4-686506786902862968107956548534431094622773*x^36*z^5+1813609196174292928153274583733559044515120*x^35*y*z^5-3708006084876346197508054881972097866701100*x^35*z^6+7915031188247209465378686238368139970052642*x^34*y*z^6-16271439840815734892670587989801505150856804*x^34*z^7+31081264908901244442946031293176177565958436*x^33*y*z^7-60169583703634475845289297053658173051876803*x^33*z^8+107192383625534267472158197062436963118705802*x^32*y*z^8-198541948944452058235462160316452107543213500*x^32*z^9+325331380833949610705258074297704629915623224*x^31*y*z^9-587238898224918777394601978100996080263094520*x^31*z^10+907078680109071839761609283207090498896798248*x^30*y*z^10-1568096716490444182657506263637081307226546895*x^30*z^11+2329333401798594968061416060626331691380835384*x^29*y*z^11-3861699338525055418788600126480070372019506998*x^29*z^12+5495665332434984931112574418941637117254431149*x^28*y*z^12-8818573748603972688765592944462869876789036760*x^28*z^13+12171006450903296006076092145984622854982319292*x^27*y*z^13-18788680549267892307170590452712895289680417097*x^27*z^14+25369221273293265878633625909721811966406780546*x^26*y*z^14-37934893564093098915220996643139303022070643450*x^26*z^15+49893465791850807692634218725448978817662748375*x^25*y*z^15-72834185026112665199187712562905620479266772802*x^25*z^16+94769573318787720274485655653966172084809874920*x^24*y*z^16-134359818889375264661107209178359374893074638148*x^24*z^17+173433088206831377688774019871297136557826542580*x^23*y*z^17-243042644087552177845324194545755765117264114434*x^23*z^18+308375786035774840682064037310876317256799413499*x^22*y*z^18-429758143927060151989916475235907313027142204290*x^22*z^19+551300423306896899329310324929488545726773153796*x^21*y*z^19-753445645490880495907607594738804635605086903295*x^21*z^20+965933764838941544644277686831994994780511339596*x^20*y*z^20-1336139706382740947509542636491296840416202811754*x^20*z^21+1680663675462149089841308147891434529944435584673*x^19*y*z^21-2328816020080402363446899870702221358386786361520*x^19*z^22+3021542614092547871290681410603902192707041786204*x^18*y*z^22-4075344405475028643981700337811952735023116699718*x^18*z^23+5202054704025306729844757912179939013649198741654*x^17*y*z^23-7243902809191011406449238510504331415643469194482*x^17*z^24+8980518480297030382810961269650565331843917681755*x^16*y*z^24-12319626276036937911582315428536353767825002403610*x^16*z^25+16201821827439146569167163365975238875168198974580*x^15*y*z^25-21343345878161028893104880504391866638575718436913*x^15*z^26+26448484038260109459310920551786377497372318164658*x^14*y*z^26-37398315940621920036848903181481236813067790935308*x^14*z^27+45367894085660391025937090796808778470675493972451*x^13*y*z^27-60396351663434067839862830995993318105859528303766*x^13*z^28+81940318727208258366888665422141306992531853825902*x^12*y*z^28-105133729317990566090890963793554364875068030835365*x^12*z^29+121676458936218977316521509673744813871618838058508*x^11*y*z^29-180708271501741733100796271896906804363497397129644*x^11*z^30+219219659895762092428414759389515563526891174523207*x^10*y*z^30-271692254661385061756175818502109170805044093857664*x^10*z^31+394232103854902700044827906817804703653121685986070*x^9*y*z^31-502377658033211069703243704538144685232662751714172*x^9*z^32+495545709047619187295187597293048288759077820086968*x^8*y*z^32-821648561308824776623931121400349477373018695459850*x^8*z^33+1070116286055771297558304268445916634252837930675145*x^7*y*z^33-1115498037027865812316415041093976912271799305957876*x^7*z^34+1767543759996345429403973928239640475828040435453574*x^6*y*z^34-2355122033471964578902547299912752239058400262068245*x^6*z^35+1625739720098867206507258324811222429414384240745294*x^5*y*z^35-3226511999933896825360324820453069340177220752689826*x^5*z^36+4793181006052162132645165731364536216183779639989128*x^4*y*z^36-3696798490760463633632505318926653148384761670821476*x^4*z^37+5509907876260532051679958879002241813627323514716066*x^3*y*z^37-5294416512622243589055182807844255656568593077995392*x^3*z^38+2667953251214518622452530038823197185935858278259018*x^2*y*z^38-3660412383618210436586978687409150845818138544539158*x^2*z^39-34603621701026571896586467135650776576*x*y^40+461381622680354291954486228475343687680*x*y^39*z-2998980547422302897704160485089733969920*x*y^38*z^2+35904358460938439229563304218118814011576*x*y^37*z^3-325693569638358587326501595300238540539784*x*y^36*z^4+1813609196174292928153274583733559044515120*x*y^35*z^5-7915031188247209465378686238368139970052642*x*y^34*z^6+31081264908901244442946031293176177565958436*x*y^33*z^7-107192383625534267472158197062436963118705802*x*y^32*z^8+325331380833949610705258074297704629915623224*x*y^31*z^9-907078680109071839761609283207090498896798248*x*y^30*z^10+2329333401798594968061416060626331691380835384*x*y^29*z^11-5495665332434984931112574418941637117254431149*x*y^28*z^12+12171006450903296006076092145984622854982319292*x*y^27*z^13-25369221273293265878633625909721811966406780546*x*y^26*z^14+49893465791850807692634218725448978817662748375*x*y^25*z^15-94769573318787720274485655653966172084809874920*x*y^24*z^16+173433088206831377688774019871297136557826542580*x*y^23*z^17-308375786035774840682064037310876317256799413499*x*y^22*z^18+551300423306896899329310324929488545726773153796*x*y^21*z^19-965933764838941544644277686831994994780511339596*x*y^20*z^20+1680663675462149089841308147891434529944435584673*x*y^19*z^21-3021542614092547871290681410603902192707041786204*x*y^18*z^22+5202054704025306729844757912179939013649198741654*x*y^17*z^23-8980518480297030382810961269650565331843917681755*x*y^16*z^24+16201821827439146569167163365975238875168198974580*x*y^15*z^25-26448484038260109459310920551786377497372318164658*x*y^14*z^26+45367894085660391025937090796808778470675493972451*x*y^13*z^27-81940318727208258366888665422141306992531853825902*x*y^12*z^28+121676458936218977316521509673744813871618838058508*x*y^11*z^29-219219659895762092428414759389515563526891174523207*x*y^10*z^30+394232103854902700044827906817804703653121685986070*x*y^9*z^31-495545709047619187295187597293048288759077820086968*x*y^8*z^32+1070116286055771297558304268445916634252837930675145*x*y^7*z^33-1767543759996345429403973928239640475828040435453574*x*y^6*z^34+1625739720098867206507258324811222429414384240745294*x*y^5*z^35-4793181006052162132645165731364536216183779639989128*x*y^4*z^36+5509907876260532051679958879002241813627323514716066*x*y^3*z^37-2667953251214518622452530038823197185935858278259018*x*y^2*z^38+4098596103027810377405100920997742659570424243132608*x*y*z^39-2097700895309560164819021830834843501254068895875584*x*z^40-11534540567008857298862155711883592192*y^40*z+1411646203189255290256579102979827590720*y^39*z^2-17351740458986217807434141510374514022720*y^38*z^3+115531294571556219739561881058777643989032*y^37*z^4-686506786902862968107956548534431094622773*y^36*z^5+3708006084876346197508054881972097866701100*y^35*z^6-16271439840815734892670587989801505150856804*y^34*z^7+60169583703634475845289297053658173051876803*y^33*z^8-198541948944452058235462160316452107543213500*y^32*z^9+587238898224918777394601978100996080263094520*y^31*z^10-1568096716490444182657506263637081307226546895*y^30*z^11+3861699338525055418788600126480070372019506998*y^29*z^12-8818573748603972688765592944462869876789036760*y^28*z^13+18788680549267892307170590452712895289680417097*y^27*z^14-37934893564093098915220996643139303022070643450*y^26*z^15+72834185026112665199187712562905620479266772802*y^25*z^16-134359818889375264661107209178359374893074638148*y^24*z^17+243042644087552177845324194545755765117264114434*y^23*z^18-429758143927060151989916475235907313027142204290*y^22*z^19+753445645490880495907607594738804635605086903295*y^21*z^20-1336139706382740947509542636491296840416202811754*y^20*z^21+2328816020080402363446899870702221358386786361520*y^19*z^22-4075344405475028643981700337811952735023116699718*y^18*z^23+7243902809191011406449238510504331415643469194482*y^17*z^24-12319626276036937911582315428536353767825002403610*y^16*z^25+21343345878161028893104880504391866638575718436913*y^15*z^26-37398315940621920036848903181481236813067790935308*y^14*z^27+60396351663434067839862830995993318105859528303766*y^13*z^28-105133729317990566090890963793554364875068030835365*y^12*z^29+180708271501741733100796271896906804363497397129644*y^11*z^30-271692254661385061756175818502109170805044093857664*y^10*z^31+502377658033211069703243704538144685232662751714172*y^9*z^32-821648561308824776623931121400349477373018695459850*y^8*z^33+1115498037027865812316415041093976912271799305957876*y^7*z^34-2355122033471964578902547299912752239058400262068245*y^6*z^35+3226511999933896825360324820453069340177220752689826*y^5*z^36-3696798490760463633632505318926653148384761670821476*y^4*z^37+5294416512622243589055182807844255656568593077995392*y^3*z^38-3660412383618210436586978687409150845818138544539158*y^2*z^39+2097700895309560164819021830834843501254068895875584*y*z^40-1131052886077853823182745988238703398382350019154584*z^41));
//   Coordinate number 1:
map_0_coord_1 := 1*(202755595904452569706561330872953769*x^42+2838578342662335975891858632221352766*x^41*z+13404397729238808775044887985489721395*x^40*y*z+14928819431779692910246071325016003436*x^40*z^2+178725303056517450333931839806529618600*x^39*y*z^2+300480455589725383982988804924402704526*x^39*z^3+1161714469867363427170556958742442520900*x^38*y*z^3+3452949492267203870196617533056948763428*x^38*z^4+7847725087901278312298557166326226194098*x^37*y*z^4+20640602936773281330140721405022806927012*x^37*z^5+51417205399851516446076563829360284605392*x^36*y*z^5+85363061890682093280088537434128410297674*x^36*z^6+254057547577991999389732613509765901486172*x^35*y*z^6+296103955391652228565825058411232027218358*x^35*z^7+841396619318739012499872750473574229610925*x^34*y*z^7+956598776367069116810663172848708149207824*x^34*z^8+1652024219539301432879260381532539916733720*x^33*y*z^8+2616999320227269466928137989682114742319615*x^33*z^9+696763746495468033577424503605760714330122*x^32*y*z^9+4791908397974400792009678163043128578301368*x^32*z^10-5449389197061805620289570295924796888459624*x^31*y*z^10+1452433023072650602068113200661974696869504*x^31*z^11-10573732057977396572942866084766100775592496*x^30*y*z^11-24361261952400695182935547514818639052395758*x^30*z^12+24981897204619892281079472239746528425493680*x^29*y*z^12-94451514101058934346748346936045838385763596*x^29*z^13+150825905167139251148106170923383082536023646*x^28*y*z^13-196887969063352910587100204016391070651907204*x^28*z^14+239748462567305809118465099253609525296430528*x^27*y*z^14-113808612350115446428298591421389949984372468*x^27*z^15-273599225822735255210304663402700794866181504*x^26*y*z^15+1006786871855850242995247308640930737867265472*x^26*z^16-2462099688863426123107538473759106559240570276*x^25*y*z^16+4976515989089509672028337697371294713217455748*x^25*z^17-7776994796074958392476589403553971614003882800*x^24*y*z^17+12958285415165688422041088497476023149802526393*x^24*z^18-17577349491398448525032760459242350381933002840*x^23*y*z^18+20789456260903858382407785859495061811074153004*x^23*z^19-22286394277570171032584421349487575170141699006*x^22*y*z^19+13559371345252698779703639561089939515599734304*x^22*z^20+22309092161187760284698693549547657747303557616*x^21*y*z^20-72759206363056070434867446280675689788593562484*x^21*z^21+185041434773028636206572719459636512697073947156*x^20*y*z^21-412752108884461006093186115950264125100309471380*x^20*z^22+699390952877349882717683194176803352969420371616*x^19*y*z^22-1271584460295380975348412565452366554244563241768*x^19*z^23+2189970846856639451674513780808743743794477987328*x^18*y*z^23-3417841421568855128294185196441249624599140888387*x^18*z^24+5147459253501281032420179151887417672162805403976*x^17*y*z^24-8417507837185268712909054295880937659027367243876*x^17*z^25+11660538313074655585692942705749760210140909943402*x^16*y*z^25-17673268361426896664790142563677793096097790117244*x^16*z^26+26448479180245117961248746466425143642079885872328*x^15*y*z^26-37045329595703356344848283187054269556497513072414*x^15*z^27+49050577741300684708726183077709972905713392733796*x^14*y*z^27-75353204573895588805387194749732659281184970862048*x^14*z^28+96517402450741573464882550616954957219614812846594*x^13*y*z^28-133769824519580410912743957002709868110988195919784*x^13*z^29+194338759361550666817376952171021600042481321127892*x^12*y*z^29-256556422587123992023227135454405204023766162674552*x^12*z^30+303856452310225359731174668616102602735933756497564*x^11*y*z^30-471414954000774638171920867363423886999554154343222*x^11*z^31+587505746926547387175935429166364131746751440852493*x^10*y*z^31-736620295040405926068944269047988005480637731408096*x^10*z^32+1101903334059398821891640063429814213810291349738272*x^9*y*z^32-1420115560046500597990042337270691558174538399736694*x^9*z^33+1406526210654210845915500111865708401766241547914360*x^8*y*z^33-2371000416812831572832468581613445621387959463336120*x^8*z^34+3116335635921021978717667792298374165922964071123484*x^7*y*z^34-3252506947798852214567618751493928987499721039377168*x^7*z^35+5190669168345826743207916387205341027467100786972260*x^6*y*z^35-6931120886896372707549730608995078878462237103811810*x^6*z^36+4785080835227145677272282490601759514640531517887340*x^5*y*z^36-9519569425977109285215838286994928491875151193246044*x^5*z^37+14157400102643005339575341726433215984943475481466198*x^4*y*z^37-10918720483175004846589604230937007958560791016480768*x^4*z^38+16281702759394979634786384513284691374512812851225700*x^3*y*z^38-15645677455556588559679824445372475296286358072550870*x^3*z^39+7884519387818880159325632095400545859899477383663836*x^2*y*z^39-10818172329987472207417738687853986073075356466762748*x^2*z^40-13404397729238808775044887985489721395*x*y^40*z+178725303056517450333931839806529618600*x*y^39*z^2-1161714469867363427170556958742442520900*x*y^38*z^3+7847725087901278312298557166326226194098*x*y^37*z^4-51417205399851516446076563829360284605392*x*y^36*z^5+254057547577991999389732613509765901486172*x*y^35*z^6-841396619318739012499872750473574229610925*x*y^34*z^7+1652024219539301432879260381532539916733720*x*y^33*z^8-696763746495468033577424503605760714330122*x*y^32*z^9-5449389197061805620289570295924796888459624*x*y^31*z^10+10573732057977396572942866084766100775592496*x*y^30*z^11+24981897204619892281079472239746528425493680*x*y^29*z^12-150825905167139251148106170923383082536023646*x*y^28*z^13+239748462567305809118465099253609525296430528*x*y^27*z^14+273599225822735255210304663402700794866181504*x*y^26*z^15-2462099688863426123107538473759106559240570276*x*y^25*z^16+7776994796074958392476589403553971614003882800*x*y^24*z^17-17577349491398448525032760459242350381933002840*x*y^23*z^18+22286394277570171032584421349487575170141699006*x*y^22*z^19+22309092161187760284698693549547657747303557616*x*y^21*z^20-185041434773028636206572719459636512697073947156*x*y^20*z^21+699390952877349882717683194176803352969420371616*x*y^19*z^22-2189970846856639451674513780808743743794477987328*x*y^18*z^23+5147459253501281032420179151887417672162805403976*x*y^17*z^24-11660538313074655585692942705749760210140909943402*x*y^16*z^25+26448479180245117961248746466425143642079885872328*x*y^15*z^26-49050577741300684708726183077709972905713392733796*x*y^14*z^27+96517402450741573464882550616954957219614812846594*x*y^13*z^28-194338759361550666817376952171021600042481321127892*x*y^12*z^29+303856452310225359731174668616102602735933756497564*x*y^11*z^30-587505746926547387175935429166364131746751440852493*x*y^10*z^31+1101903334059398821891640063429814213810291349738272*x*y^9*z^32-1406526210654210845915500111865708401766241547914360*x*y^8*z^33+3116335635921021978717667792298374165922964071123484*x*y^7*z^34-5190669168345826743207916387205341027467100786972260*x*y^6*z^35+4785080835227145677272282490601759514640531517887340*x*y^5*z^36-14157400102643005339575341726433215984943475481466198*x*y^4*z^37+16281702759394979634786384513284691374512812851225700*x*y^3*z^38-7884519387818880159325632095400545859899477383663836*x*y^2*z^39+12113717844613581676609376614213375771721669081124366*x*y*z^40-6199951959079540004726886505333147972461617232140044*x*z^41+202755595904452569706561330872953769*y^42-2838578342662335975891858632221352766*y^41*z+14928819431779692910246071325016003436*y^40*z^2-300480455589725383982988804924402704526*y^39*z^3+3452949492267203870196617533056948763428*y^38*z^4-20640602936773281330140721405022806927012*y^37*z^5+85363061890682093280088537434128410297674*y^36*z^6-296103955391652228565825058411232027218358*y^35*z^7+956598776367069116810663172848708149207824*y^34*z^8-2616999320227269466928137989682114742319615*y^33*z^9+4791908397974400792009678163043128578301368*y^32*z^10-1452433023072650602068113200661974696869504*y^31*z^11-24361261952400695182935547514818639052395758*y^30*z^12+94451514101058934346748346936045838385763596*y^29*z^13-196887969063352910587100204016391070651907204*y^28*z^14+113808612350115446428298591421389949984372468*y^27*z^15+1006786871855850242995247308640930737867265472*y^26*z^16-4976515989089509672028337697371294713217455748*y^25*z^17+12958285415165688422041088497476023149802526393*y^24*z^18-20789456260903858382407785859495061811074153004*y^23*z^19+13559371345252698779703639561089939515599734304*y^22*z^20+72759206363056070434867446280675689788593562484*y^21*z^21-412752108884461006093186115950264125100309471380*y^20*z^22+1271584460295380975348412565452366554244563241768*y^19*z^23-3417841421568855128294185196441249624599140888387*y^18*z^24+8417507837185268712909054295880937659027367243876*y^17*z^25-17673268361426896664790142563677793096097790117244*y^16*z^26+37045329595703356344848283187054269556497513072414*y^15*z^27-75353204573895588805387194749732659281184970862048*y^14*z^28+133769824519580410912743957002709868110988195919784*y^13*z^29-256556422587123992023227135454405204023766162674552*y^12*z^30+471414954000774638171920867363423886999554154343222*y^11*z^31-736620295040405926068944269047988005480637731408096*y^10*z^32+1420115560046500597990042337270691558174538399736694*y^9*z^33-2371000416812831572832468581613445621387959463336120*y^8*z^34+3252506947798852214567618751493928987499721039377168*y^7*z^35-6931120886896372707549730608995078878462237103811810*y^6*z^36+9519569425977109285215838286994928491875151193246044*y^5*z^37-10918720483175004846589604230937007958560791016480768*y^4*z^38+15645677455556588559679824445372475296286358072550870*y^3*z^39-10818172329987472207417738687853986073075356466762748*y^2*z^40+6199951959079540004726886505333147972461617232140044*y*z^41-3342997132859944253998497033128984564004550911503625*z^42);
